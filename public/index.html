<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel・CSV変換ツール</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>データ変換システム</h1>
            <p>Excelを取り込み、貼り付けデータと統合してCSVを出力します</p>
        </header>

        <div class="card">
            <div class="card-header">
                <span class="step-badge">STEP 1</span>
                <h2>Excelファイルを選択</h2>
            </div>
            
            <div class="upload-area" id="dropZone">
                <input type="file" id="uploadFile" accept=".xlsx">
                <div class="upload-content">
                    <svg class="excel-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path fill="#217346" d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
                    </svg>
                    <p class="upload-text">ここにExcelファイルをドロップ<br>または <span>クリックして選択</span></p>
                    <p id="fileNameDisplay" class="file-name"></p>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <span class="step-badge">STEP 2</span>
                <h2>データの貼り付け</h2>
            </div>
            <p class="instruction">枠内の左上をクリックし、データを貼り付けてください (Ctrl+V)</p>
            
            <div class="table-container">
                <table id="inputTable">
                    <thead>
                        <tr>
                            <th>お子さま</th>
                            <th>フリガナ</th>
                            <th>性別</th>
                            <th>年齢</th>
                            <th>生年月日</th>
                            <th>保護者</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>
            </div>
        </div>

        <div class="action-area">
            <button id="convertBtn" onclick="processData()">
                CSVに変換してダウンロード
            </button>
            <div id="statusMessage"></div>
            <a id="downloadLink" style="display:none;"></a>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // ファイル選択時の名前表示ロジックを追加
        document.getElementById('uploadFile').addEventListener('change', function(e) {
            const fileName = e.target.files[0] ? e.target.files[0].name : "";
            document.getElementById('fileNameDisplay').textContent = fileName;
            if(fileName) {
                document.querySelector('.upload-area').classList.add('has-file');
            }
        });
    </script>
</body>
</html>
